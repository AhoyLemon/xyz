mixin timeStamp(t)
  - var d
  if t
    - d = new Date(t)
  else
    - d = new Date()


  - var m = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ]
  time 
    = m[d.getMonth()] 
    |  
    = d.getDate()
    | , 
    = d.getFullYear() 
  //- var lastUpdated = d.getFullYear() + '-' + (d.getMonth()<10?'0':'') + d.getMonth() + '-' + (d.getDate()<10?'0':'') + d.getDate() + '@' + (d.getHours()<10?'0':'') + d.getHours() + ':' + (d.getMinutes()<10?'0':'') + d.getMinutes() + ':' + (d.getSeconds()<10?'0':'') + d.getSeconds()  


mixin formatDate(e, f)
  if !e
    - var x = new Date()
    - var e = x.getFullYear() + '-' + (x.getMonth()<10?'0':'') + x.getMonth() + '-' + (x.getDate()<10?'0':'') + x.getDate()
  - var allMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ]
  - var MonthAbbr = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ]
  - var g = e.split("-");
  if f == "m d"
    time
      = MonthAbbr[parseInt(g[1] - 1)]
      |  
      = g[2]
  else
    time
      = MonthAbbr[parseInt(g[1] - 1)]
      |  
      = g[2]
      | , 
      = g[0]


mixin dateRange(e,f)
  - var allMonths = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ]
  - var MonthAbbr = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ]
  - var g = e.split("-");
  - var h = f.split("-");

  if (g[1] == h[1])
    time
      = MonthAbbr[parseInt(g[1] - 1)]
      |  
      = g[2]
      |  -  
      = h[2]
      | ,  
      = h[0]
  else
    time
      = MonthAbbr[parseInt(g[1] - 1)]
      |  
      = g[2]
      |  -  
      = MonthAbbr[parseInt(h[1] - 1)]
      |  
      = h[2]
      | ,  
      = h[0]
      


mixin link(title,url)
  a(href=url target="_blank" nofollow noopener)= title

mixin card(title, url, background, logo, launched)
  figure.card
    a.flipper(href=url)
      - var styl
      if background.includes('#')
        - styl = "background-color:" + background
      else if background.includes('.jpg')
        - styl = "background-image:url(img/"+background+")"
      .front(style=styl)
        if logo.includes('svg')
          img.logo(src="svg/"+logo alt=title+" logo")
        else
          img.logo(src="img/"+logo alt=title+" logo")
      .back
        h3.title= title
        block

mixin prevTalk(title,img,d,city)
  .talk
    figure(style="background-image:url(img/talks/"+img+")")
    figcaption
      .conference #{title}
      time #{d}
      .city #{city}

mixin talkSlider(w)
  if w == "upcoming"
    .upcoming-conferences.conferences
      .slider-header
        h2 
          | UPCOMING TALKS 
          sub (#{upcomingTalks.length})
        .more-holder
          a(href="talks.html") see all
      .upcoming-conference-carousel.carousel
        each t,index in upcomingTalks
          .conference.upcoming
            if t.name && t.url
              .name
                a(href=t.url target="_blank")= t.name
            else if t.name
              .name= t.name
            .location
              
              if t.city && t.state
                span #{t.city}, #{t.state}
                if t.online
                  span  (virtual)
              else if t.city && t.country
                span #{t.city}, #{t.country}
                if t.online
                  span  (virtual)
              else if t.online
                span Online Conference
            .date
              // Date
              if t.postponed
                strong POSTPONED
              else if t.startDate && t.endDate
                +dateRange(t.startDate, t.endDate)
              else if t.date
                .date(itemprop="startDate" content=t.date)
                  +formatDate(t.date)
                //-meta(itemprop="endDate" content=t.date)


            .presenting Presenting:
            if t.talks
              ul.multiple-talks
                each u,uindex in t.talks
                  li.talk= u
            else if t.talk
              ul
                li.talk= t.talk

        if upcomingTalks.length < 1
          .conference.upcoming(style="display:flex; align-items:center; justify-content:center;")
            p(style="font-size:120%") None currently scheduled.

        if upcomingTalks.length < 2
          .conference.upcoming(style="display:flex; align-items:center; justify-content:center;")
            p(style="font-size:120%")
              a(href="https://sessionize.com/lemon") Invite me to speak
              | , please.

  else if w == 'previous'
    .previous-conferences.conferences
      .slider-header
        h2 
          | PREVIOUS TALKS 
          sub (#{previousTalks.length})
        .more-holder
          a(href="talks.html#previous") see all
      .previous-conference-carousel.carousel
        each t,index in previousTalks
          - let p = ""
          if t.pics
            - p = "img/talks/" + t.pics[0]
          else if t.img
            - p = "img/talks/" + t.img
          figure.conference.prev(style="background-image:url("+p+")")
            figcaption
              .name= t.name
                //-a(href=t.url target="_blank")= t.name
              .location(style="text-transform:uppercase; font-size:100%; font-weight:bold;")
                if t.city && t.state
                  span #{t.city}, #{t.state}
                else if t.city && t.country
                  span #{t.city}, #{t.country}
              .date
                if t.startDate && t.endDate
                  .date
                    span(itemprop="startDate" content=t.startDate)
                      +formatDate(t.startDate, "m d")
                    | - 
                    span(itemprop="endDate" content=t.endDate)
                      +formatDate(t.endDate)
                else if t.date
                  .date(itemprop="startDate" content=t.date)
                    +formatDate(t.date)

mixin projectSummary(s)
  - let bgStyle = ""
  - let fgImage = ""
  - let bgiFile = ""
  if s.bgColor
    - bgStyle = "background-color:" + s.bgColor +"; "
  else if s.bgImage
    if s.bgImage.includes("svg")
      - bgiFile = "svg/"+s.bgImage
    else if s.bgImage
      - bgiFile = "img/"+s.bgImage
    - bgStyle = "background-image:url("+bgiFile+"); "
  else if s.bgGradient
    - bgStyle = "background:"+s.bgGradient+"; "

  if s.fgImage
    if s.fgImage.includes("svg")
      - fgImage = "svg/"+s.fgImage
    else if s.fgImage
      - fgImage = "img/"+s.fgImage

  .project(repo=s.repo)
    figure(style=bgStyle)
      if fgImage != ""
        a(href=s.url)
          img.logo(src=fgImage alt=s.title+" logo")
      else if s.bgImage
        a.absolute-link(href=s.url style=bgStyle)
          //-img.logo(src=bgiFile)
    figcaption
      .title
        a(href=s.url)= s.title
      if (s.subhead)
        .subhead= s.subhead
      else if (s.type)
        .type= s.type

      .description !{s.description}

    .detail-row
      //-if (s.type)
        .detail
          .label &nbsp;
          .value= s.type
      if (s.launched)
        .detail.launched
          .label LAUNCHED
          .value
            +formatDate(s.launched)
      if s.repo
        .detail.last-updated.invisible
          .label LAST UPDATED
          .value
      if (s.retired)
        .detail.retired
          .label RETIRED
          .value
            +formatDate(s.retired)
      if s.repo
        .detail.repository
          .label REPOSITORY
          .value
            //-a(href="https://github.com/"+s.repo)
              svg(viewbox='0 0 24 24' xmlns='http://www.w3.org/2000/svg')
                title GitHub icon
                path(d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12')
            a(href="https://github.com/"+s.repo target="_blank")
              span= s.repo.split('/')[1]
              


    
    if s.repo
      - let repoURL = ""
      if s.repo == ( "AhoyLemon/kinda.fun" || "AhoyLemon/damn.dog" || "AhoyLemon/TheFPlus" )
        - repoURL = "https://api.github.com/repos/" + s.repo + "/commits/main"
      else 
        - repoURL = "https://api.github.com/repos/" + s.repo + "/commits/master"
      script.

        $.ajax({
          url: "#{repoURL}",
          dataType: 'json',
          success: function( data ) {
            var items = [];
            let timeStamp = data.commit.author.date;
            let lU = timeStamp.split('T');
            let lastUpdated = lU[0];
            console.log(lastUpdated);
            if (lastUpdated) {
              $('.project[repo="#{s.repo}"] .last-updated .value').html(formatDate(lastUpdated));
              $('.project[repo="#{s.repo}"] .last-updated').removeClass('invisible');
            }
          },
          error: function( data ) {
            console.log('ERROR ' + data.status + ' on #{s.repo}');
            //$('.project[repo="#{s.repo}"] .last-updated').remove();
          }
        });



mixin techIcon(i)
  - i = i.toLowerCase()
  if i == "php"
    svg(role='img', viewBox='0 0 24 24', xmlns='http://www.w3.org/2000/svg')
      title PHP
      path(d='M7.01 10.207h-.944l-.515 2.648h.838c.556 0 .97-.105 1.242-.314.272-.21.455-.559.55-1.049.092-.47.05-.802-.124-.995-.175-.193-.523-.29-1.047-.29zM12 5.688C5.373 5.688 0 8.514 0 12s5.373 6.313 12 6.313S24 15.486 24 12c0-3.486-5.373-6.312-12-6.312zm-3.26 7.451c-.261.25-.575.438-.917.551-.336.108-.765.164-1.285.164H5.357l-.327 1.681H3.652l1.23-6.326h2.65c.797 0 1.378.209 1.744.628.366.418.476 1.002.33 1.752a2.836 2.836 0 0 1-.305.847c-.143.255-.33.49-.561.703zm4.024.715l.543-2.799c.063-.318.039-.536-.068-.651-.107-.116-.336-.174-.687-.174H11.46l-.704 3.625H9.388l1.23-6.327h1.367l-.327 1.682h1.218c.767 0 1.295.134 1.586.401s.378.7.263 1.299l-.572 2.944h-1.389zm7.597-2.265a2.782 2.782 0 0 1-.305.847c-.143.255-.33.49-.561.703a2.44 2.44 0 0 1-.917.551c-.336.108-.765.164-1.286.164h-1.18l-.327 1.682h-1.378l1.23-6.326h2.649c.797 0 1.378.209 1.744.628.366.417.477 1.001.331 1.751zM17.766 10.207h-.943l-.516 2.648h.838c.557 0 .971-.105 1.242-.314.272-.21.455-.559.551-1.049.092-.47.049-.802-.125-.995s-.524-.29-1.047-.29z')
  else if i == "sass" || i == "scss"
    svg(role='img', viewBox='0 0 24 24', xmlns='http://www.w3.org/2000/svg')
      title Sass
      path(d='M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zM9.615 15.998c.175.645.156 1.248-.024 1.792l-.065.18c-.024.061-.052.12-.078.176-.14.29-.326.56-.555.81-.698.759-1.672 1.047-2.09.805-.45-.262-.226-1.335.584-2.19.871-.918 2.12-1.509 2.12-1.509v-.003l.108-.061zm9.911-10.861c-.542-2.133-4.077-2.834-7.422-1.645-1.989.707-4.144 1.818-5.693 3.267C4.568 8.48 4.275 9.98 4.396 10.607c.427 2.211 3.457 3.657 4.703 4.73v.006c-.367.18-3.056 1.529-3.686 2.925-.675 1.47.105 2.521.615 2.655 1.575.436 3.195-.36 4.065-1.649.84-1.261.766-2.881.404-3.676.496-.135 1.08-.195 1.83-.104 2.101.24 2.521 1.56 2.43 2.1-.09.539-.523.854-.674.944-.15.091-.195.12-.181.181.015.09.091.09.21.075.165-.03 1.096-.45 1.141-1.471.045-1.29-1.186-2.729-3.375-2.7-.9.016-1.471.091-1.875.256-.03-.045-.061-.075-.105-.105-1.35-1.455-3.855-2.475-3.75-4.41.03-.705.285-2.564 4.8-4.814 3.705-1.846 6.661-1.335 7.171-.21.733 1.604-1.576 4.59-5.431 5.024-1.47.165-2.235-.404-2.431-.615-.209-.225-.239-.24-.314-.194-.12.06-.045.255 0 .375.12.3.585.825 1.396 1.095.704.225 2.43.359 4.5-.45 2.324-.899 4.139-3.405 3.614-5.505l.073.067z')
  else if i == "javascript" || i == "js"
    svg(role='img', viewBox='0 0 24 24', xmlns='http://www.w3.org/2000/svg')
      title JavaScript
      path(d='M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873-.736-.345-1.554-.585-1.797-1.14-.091-.33-.105-.51-.046-.705.15-.646.915-.84 1.515-.66.39.12.75.42.976.9 1.034-.676 1.034-.676 1.755-1.125-.27-.42-.404-.601-.586-.78-.63-.705-1.469-1.065-2.834-1.034l-.705.089c-.676.165-1.32.525-1.71 1.005-1.14 1.291-.811 3.541.569 4.471 1.365 1.02 3.361 1.244 3.616 2.205.24 1.17-.87 1.545-1.966 1.41-.811-.18-1.26-.586-1.755-1.336l-1.83 1.051c.21.48.45.689.81 1.109 1.74 1.756 6.09 1.666 6.871-1.004.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805 0 1.232.063 2.363-.138 2.711-.33.689-1.18.601-1.566.48-.396-.196-.597-.466-.83-.855-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517.855.51 2.004.675 3.207.405.783-.226 1.458-.691 1.811-1.411.51-.93.402-2.07.397-3.346.012-2.054 0-4.109 0-6.179l.004-.056z')
  else if i == "pug"
    svg(viewBox='0 0 24 24', xmlns='http://www.w3.org/2000/svg')
      title Pug
      path(d='M12.094 4.636c-2.066 0-3.682.204-4.922.57a6.451 6.451 0 0 0 .091-.084c.038-.037-.05-.062-.228-.068-.534-.018-1.867.143-2.99.705C2.772 6.358-.073 9.504 0 9.69c.075.187 1.46 1.345 1.872 1.795.262.3 1.048 2.959 1.76 2.51.188-.131.265-.651.33-1.293.058.497.115 1.013.193 1.48.112.749 1.087 1.347 1.2 2.059.138 1.014.76 1.723 1.98 2.174.484.668 1.238.33 1.8.634.9.487 1.91.262 2.92.262 1.012 0 1.985.186 2.92-.3.577-.3 1.32.03 1.81-.58 1.225-.45 1.831-1.164 1.972-2.19.112-.712 1.048-1.31 1.16-2.059.064-.38.11-.802.158-1.203.057.5.13.904.291 1.016.674.449 1.498-2.21 1.76-2.51.412-.45 1.797-1.608 1.872-1.795.074-.188-2.808-3.333-4.08-3.932-1.124-.562-2.457-.723-2.991-.705-.167.005-.245.029-.225.062-1.174-.308-2.672-.48-4.61-.48zm.03.5c2.203 0 3.848.225 5.01.615.133.045.238.098.358.147.69.715 1.624 1.83 2.014 3.117.025.08.04.166.063.248v.008c.045.77.316 1.417.23 1.99-.153.998-.228 1.973-.373 2.84l-.002.004v.004c-.029.192-.218.476-.478.807-.261.33-.596.702-.682 1.248v.006l-.002.003c-.1.733-.42 1.2-1.17 1.582.125-.444.205-1.055.205-1.963.037-1.123.077-1.572-.86-2.695a5.53 5.53 0 0 0-2.792-1.898c-.111-.39-.722-.836-1.551-.836s-1.415.422-1.535.82a5.533 5.533 0 0 0-2.846 1.914c-.936 1.123-.86 1.61-.86 2.696 0 .903.08 1.513.203 1.96-.77-.384-1.107-.856-1.207-1.58v-.01c-.087-.553-.437-.923-.707-1.253-.27-.33-.462-.617-.49-.801l-.002-.004V14.1c-.144-.867-.22-1.84-.373-2.838v-.002c-.085-.573.183-1.22.229-1.99v.015c.013-.143.017-.24.025-.37.36-1.16 1.153-2.173 1.805-2.876a6.413 6.413 0 0 1 .724-.289c1.192-.391 2.86-.615 5.063-.615zM6.913 8.94a1.647 1.647 0 0 0-1.635 1.648 1.647 1.647 0 0 0 1.648 1.647 1.647 1.647 0 0 0 .442-.06c.349-.376.718-.723 1.111-1.042a1.647 1.647 0 0 0 .094-.545 1.647 1.647 0 0 0-1.647-1.648 1.647 1.647 0 0 0-.013 0zm10.297 0a1.647 1.647 0 0 0-1.637 1.648 1.647 1.647 0 0 0 .15.684c.313.264.612.547.895.848a1.647 1.647 0 0 0 .604.115 1.647 1.647 0 0 0 1.646-1.647 1.647 1.647 0 0 0-1.646-1.648 1.647 1.647 0 0 0-.012 0zm-9.871.486a.412.412 0 0 1 .41.412.412.412 0 0 1-.41.412.412.412 0 0 1-.413-.412.412.412 0 0 1 .413-.412zm9.47 0a.412.412 0 0 1 .413.412.412.412 0 0 1-.412.412.412.412 0 0 1-.412-.412.412.412 0 0 1 .412-.412zm-5.109 1.486a.15.3 17.23 0 1 .03.004.15.3 17.23 0 1 .054.33.15.3 17.23 0 1-.232.243.15.3 17.23 0 1-.053-.33.15.3 17.23 0 1 .201-.247zm.672.022a.3.15 75.54 0 1 .205.254.3.15 75.54 0 1-.07.328.3.15 75.54 0 1-.22-.252.3.15 75.54 0 1 .07-.328.3.15 75.54 0 1 .015-.002zm-.316.476s.035.226.185.301c.15.075.862-.15.862-.15-.337.262-.973.263-.973.338v.373c0 .408.026 1.461-.031 1.685.823.005 2.09 1.126 2.09 2.508v.075c-.038-1.348-1.61-2.434-2.096-2.434-.487 0-2.06 1.048-2.098 2.434v-.075c0-1.362 1.233-2.47 2.057-2.506-.07-.551-.073-1.137-.073-1.687V11.9a5.098 5.098 0 0 0-.656-.237c.185.033.371.05.545.05.15-.076.188-.302.188-.302zM9.015 12.76a.15.15 0 0 1 .008 0 .15.15 0 0 1 .15.15.15.15 0 0 1-.15.151.15.15 0 0 1-.15-.15.15.15 0 0 1 .142-.15zm1.124 0a.15.15 0 0 1 .007 0 .15.15 0 0 1 .15.15.15.15 0 0 1-.15.151.15.15 0 0 1-.15-.15.15.15 0 0 1 .143-.15zm3.67 0a.15.15 0 0 1 .007 0 .15.15 0 0 1 .15.15.15.15 0 0 1-.15.151.15.15 0 0 1-.15-.15.15.15 0 0 1 .143-.15zm1.123 0a.15.15 0 0 1 .008 0 .15.15 0 0 1 .15.15.15.15 0 0 1-.15.151.15.15 0 0 1-.15-.15.15.15 0 0 1 .142-.15zm-5.653.899a.15.15 0 0 1 .008 0 .15.15 0 0 1 .148.15.15.15 0 0 1-.148.15.15.15 0 0 1-.15-.15.15.15 0 0 1 .142-.15zm5.391 0a.15.15 0 0 1 .006 0 .15.15 0 0 1 .15.15.15.15 0 0 1-.15.15.15.15 0 0 1-.149-.15.15.15 0 0 1 .143-.15Z')
  else if i == "kirby"
    svg(role='img', viewBox='0 0 24 24', xmlns='http://www.w3.org/2000/svg')
      title Kirby
      path(d='M16.571 12l-2.857 1.48v.234h2.857V16H7.43v-2.286h2.857v-.25L7.429 12V9.143L12 11.598l4.571-2.455M12 0l10.286 5.999V18L12 24 1.714 18.001V6zM2.857 6.682v10.636L12 22.651l9.143-5.333V6.682L12 1.349Z')


mixin clientSiteSummary(s)

  .project.client-site
    figure
    figcaption
      .title
        a(href=s.url)= s.title
      if s.problem
        .problem
          h3 The Problem
          | !{s.problem}
      if s.solution
        .solution
          h3 The Solution
          | !{s.solution}

      if s.tech 
        .tech
          each tech in s.tech
            +techIcon(tech)